<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Upgrading a Clearwater Deployment &mdash; Project Clearwater 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Project Clearwater 1.0 documentation" href="index.html" />
    <link rel="next" title="Modifying Clearwater Settings" href="Modifying_Clearwater_settings.html" />
    <link rel="prev" title="Using Zoiper with Clearwater" href="Configuring_Zoiper_Android_iOS_Client.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="upgrading-a-clearwater-deployment">
<h1>Upgrading a Clearwater Deployment<a class="headerlink" href="#upgrading-a-clearwater-deployment" title="Permalink to this headline">¶</a></h1>
<p>This article explains how to upgrade a Project Clearwater deployment.</p>
<div class="section" id="quick-upgrade">
<h2>Quick Upgrade<a class="headerlink" href="#quick-upgrade" title="Permalink to this headline">¶</a></h2>
<p>The quickest way to upgrade is to simply upgrade all your nodes in any
order. There is no need to wait for one node to finish upgrading before
moving onto the next.</p>
<p>This is recommended if you:</p>
<ul class="simple">
<li>Do not have a fault-tolerant deployment (e.g. the All-in-One image,
or a deployment with one node of each type) OR</li>
<li>Do not need to provide uninterrupted service to users of your system.</li>
</ul>
<p>Note that during a quick upgrade your users may be unable to register,
or make and receive calls. If you do have a fault-tolerant deployment
and need uninterrupted service, see &#8220;Seamless Upgrade&#8221; below.</p>
<div class="section" id="manual-install">
<h3>Manual Install<a class="headerlink" href="#manual-install" title="Permalink to this headline">¶</a></h3>
<p>If you installed your system using the <a class="reference external" href="Manual_Install.md">Manual Install
Instructions</a>, run
<code class="docutils literal"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">update</span> <span class="pre">-o</span> <span class="pre">Dir::Etc::sourcelist=&quot;sources.list.d/clearwater.list&quot;</span> <span class="pre">-o</span> <span class="pre">Dir::Etc::sourceparts=&quot;-&quot;</span> <span class="pre">-o</span> <span class="pre">APT::Get::List-Cleanup=&quot;0&quot;</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">clearwater-infrastructure</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">clearwater-upgrade</span></code>
on each node.</p>
</div>
<div class="section" id="chef-install">
<h3>Chef Install<a class="headerlink" href="#chef-install" title="Permalink to this headline">¶</a></h3>
<p>If you installed your deployment with
<a class="reference external" href="Creating_a_deployment_with_Chef.md">chef</a>:</p>
<ul class="simple">
<li>Follow the instructions to <a class="reference external" href="https://github.com/Metaswitch/chef#updating-the-chef-server">update the Chef
server</a></li>
<li>Run
<code class="docutils literal"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">update</span> <span class="pre">-o</span> <span class="pre">Dir::Etc::sourcelist=&quot;sources.list.d/clearwater.list&quot;</span> <span class="pre">-o</span> <span class="pre">Dir::Etc::sourceparts=&quot;-&quot;</span> <span class="pre">-o</span> <span class="pre">APT::Get::List-Cleanup=&quot;0&quot;</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">clearwater-infrastructure</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">chef-client</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">clearwater-upgrade</span></code>
on each node.</li>
</ul>
</div>
</div>
<div class="section" id="seamless-upgrade">
<h2>Seamless Upgrade<a class="headerlink" href="#seamless-upgrade" title="Permalink to this headline">¶</a></h2>
<p>If your deployment contains at least two nodes of each type (excluding
Ellis) it is possible to perform a <em>seamless upgrade</em> that does not
result in any loss of service.</p>
<p>To achieve this the nodes must be upgraded one at a time and in a
specific order: first all Ralf nodes (if present), then Homestead,
Homer, Sprout, Memento (if present), Gemini (if present), Bono, and
finally Ellis.</p>
<p>For example if your deployment has two Homesteads, two Homers, two
Sprouts, two Bonos, and one Ellis, you should upgrade them in the
following order:</p>
<ul class="simple">
<li>Homestead-1</li>
<li>Homestead-2</li>
<li>Homer-1</li>
<li>Homer-2</li>
<li>Sprout-1</li>
<li>Sprout-2</li>
<li>Bono-1</li>
<li>Bono-2</li>
<li>Ellis</li>
</ul>
<div class="section" id="id1">
<h3>Manual Install<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>If you installed your system using the <a class="reference external" href="Manual_Install.md">Manual Install
Instructions</a> run
<code class="docutils literal"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">update</span> <span class="pre">-o</span> <span class="pre">Dir::Etc::sourcelist=&quot;sources.list.d/clearwater.list&quot;</span> <span class="pre">-o</span> <span class="pre">Dir::Etc::sourceparts=&quot;-&quot;</span> <span class="pre">-o</span> <span class="pre">APT::Get::List-Cleanup=&quot;0&quot;</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">clearwater-infrastructure</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">clearwater-upgrade</span></code>
on each node in the order described above.</p>
</div>
<div class="section" id="id2">
<h3>Chef Install<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>If you installed your deployment with
<a class="reference external" href="Creating_a_deployment_with_Chef.md">chef</a>:</p>
<ul class="simple">
<li>Follow the instructions to <a class="reference external" href="https://github.com/Metaswitch/chef#updating-the-chef-server">update the Chef
server</a></li>
<li>Run
<code class="docutils literal"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">update</span> <span class="pre">-o</span> <span class="pre">Dir::Etc::sourcelist=&quot;sources.list.d/clearwater.list&quot;</span> <span class="pre">-o</span> <span class="pre">Dir::Etc::sourceparts=&quot;-&quot;</span> <span class="pre">-o</span> <span class="pre">APT::Get::List-Cleanup=&quot;0&quot;</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">clearwater-infrastructure</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">chef-client</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">clearwater-upgrade</span></code>
on each node in the order described above.</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Upgrading a Clearwater Deployment</a><ul>
<li><a class="reference internal" href="#quick-upgrade">Quick Upgrade</a><ul>
<li><a class="reference internal" href="#manual-install">Manual Install</a></li>
<li><a class="reference internal" href="#chef-install">Chef Install</a></li>
</ul>
</li>
<li><a class="reference internal" href="#seamless-upgrade">Seamless Upgrade</a><ul>
<li><a class="reference internal" href="#id1">Manual Install</a></li>
<li><a class="reference internal" href="#id2">Chef Install</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Configuring_Zoiper_Android_iOS_Client.html" title="previous chapter">Using Zoiper with Clearwater</a></li>
      <li>Next: <a href="Modifying_Clearwater_settings.html" title="next chapter">Modifying Clearwater Settings</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Upgrading_a_Clearwater_deployment.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Metaswitch Networks.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="_sources/Upgrading_a_Clearwater_deployment.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>